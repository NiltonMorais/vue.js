{"version":3,"sources":["test.js"],"names":[],"mappings":"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","file":"test-compiled.js","sourcesContent":["require('./source-map-support').install({\n  emptyCacheBetweenOperations: true // Needed to be able to test for failure\n});\n\nvar SourceMapGenerator = require('source-map').SourceMapGenerator;\nvar child_process = require('child_process');\nvar assert = require('assert');\nvar fs = require('fs');\n\nfunction compareLines(actual, expected) {\n  assert(actual.length >= expected.length, 'got ' + actual.length + ' lines but expected at least ' + expected.length + ' lines');\n  for (var i = 0; i < expected.length; i++) {\n    // Some tests are regular expressions because the output format changed slightly between node v0.9.2 and v0.9.3\n    if (expected[i] instanceof RegExp) {\n      assert(expected[i].test(actual[i]), JSON.stringify(actual[i]) + ' does not match ' + expected[i]);\n    } else {\n      assert.equal(actual[i], expected[i]);\n    }\n  }\n}\n\nfunction createEmptySourceMap() {\n  return new SourceMapGenerator({\n    file: '.generated.js',\n    sourceRoot: '.'\n  });\n}\n\nfunction createSourceMapWithGap() {\n  var sourceMap = createEmptySourceMap();\n  sourceMap.addMapping({\n    generated: { line: 100, column: 0 },\n    original: { line: 100, column: 0 },\n    source: '.original.js'\n  });\n  return sourceMap;\n}\n\nfunction createSingleLineSourceMap() {\n  var sourceMap = createEmptySourceMap();\n  sourceMap.addMapping({\n    generated: { line: 1, column: 0 },\n    original: { line: 1, column: 0 },\n    source: '.original.js'\n  });\n  return sourceMap;\n}\n\nfunction createSecondLineSourceMap() {\n  var sourceMap = createEmptySourceMap();\n  sourceMap.addMapping({\n    generated: { line: 2, column: 0 },\n    original: { line: 1, column: 0 },\n    source: '.original.js'\n  });\n  return sourceMap;\n}\n\nfunction createMultiLineSourceMap() {\n  var sourceMap = createEmptySourceMap();\n  for (var i = 1; i <= 100; i++) {\n    sourceMap.addMapping({\n      generated: { line: i, column: 0 },\n      original: { line: 1000 + i, column: 99 + i },\n      source: 'line' + i + '.js'\n    });\n  }\n  return sourceMap;\n}\n\nfunction createMultiLineSourceMapWithSourcesContent() {\n  var sourceMap = createEmptySourceMap();\n  var original = new Array(1001).join('\\n');\n  for (var i = 1; i <= 100; i++) {\n    sourceMap.addMapping({\n      generated: { line: i, column: 0 },\n      original: { line: 1000 + i, column: 4 },\n      source: 'original.js'\n    });\n    original += '    line ' + i + '\\n';\n  }\n  sourceMap.setSourceContent('original.js', original);\n  return sourceMap;\n}\n\nfunction compareStackTrace(sourceMap, source, expected) {\n  // Check once with a separate source map\n  fs.writeFileSync('.generated.js.map', sourceMap);\n  fs.writeFileSync('.generated.js', 'exports.test = function() {' +\n    source.join('\\n') + '};//@ sourceMappingURL=.generated.js.map');\n  try {\n    delete require.cache[require.resolve('./.generated')];\n    require('./.generated').test();\n  } catch (e) {\n    compareLines(e.stack.split('\\n'), expected);\n  }\n  fs.unlinkSync('.generated.js');\n  fs.unlinkSync('.generated.js.map');\n\n  // Check again with an inline source map (in a data URL)\n  fs.writeFileSync('.generated.js', 'exports.test = function() {' +\n    source.join('\\n') + '};//@ sourceMappingURL=data:application/json;base64,' +\n    new Buffer(sourceMap.toString()).toString('base64'));\n  try {\n    delete require.cache[require.resolve('./.generated')];\n    require('./.generated').test();\n  } catch (e) {\n    compareLines(e.stack.split('\\n'), expected);\n  }\n  fs.unlinkSync('.generated.js');\n}\n\nfunction compareStdout(done, sourceMap, source, expected) {\n  fs.writeFileSync('.original.js', 'this is the original code');\n  fs.writeFileSync('.generated.js.map', sourceMap);\n  fs.writeFileSync('.generated.js', source.join('\\n') +\n    '//@ sourceMappingURL=.generated.js.map');\n  child_process.exec('node ./.generated', function(error, stdout, stderr) {\n    try {\n      compareLines(\n        (stdout + stderr)\n          .trim()\n          .split('\\n')\n          .filter(function (line) { return line !== '' }), // Empty lines are not relevant.\n        expected\n      );\n    } catch (e) {\n      return done(e);\n    }\n    fs.unlinkSync('.generated.js');\n    fs.unlinkSync('.generated.js.map');\n    fs.unlinkSync('.original.js');\n    done();\n  });\n}\n\nit('normal throw', function() {\n  compareStackTrace(createMultiLineSourceMap(), [\n    'throw new Error(\"test\");'\n  ], [\n    'Error: test',\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line1\\.js:1001:101\\)$/\n  ]);\n});\n\nit('throw inside function', function() {\n  compareStackTrace(createMultiLineSourceMap(), [\n    'function foo() {',\n    '  throw new Error(\"test\");',\n    '}',\n    'foo();'\n  ], [\n    'Error: test',\n    /^    at foo \\((?:.*\\/)?line2\\.js:1002:102\\)$/,\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line4\\.js:1004:104\\)$/\n  ]);\n});\n\nit('throw inside function inside function', function() {\n  compareStackTrace(createMultiLineSourceMap(), [\n    'function foo() {',\n    '  function bar() {',\n    '    throw new Error(\"test\");',\n    '  }',\n    '  bar();',\n    '}',\n    'foo();'\n  ], [\n    'Error: test',\n    /^    at bar \\((?:.*\\/)?line3\\.js:1003:103\\)$/,\n    /^    at foo \\((?:.*\\/)?line5\\.js:1005:105\\)$/,\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line7\\.js:1007:107\\)$/\n  ]);\n});\n\nit('eval', function() {\n  compareStackTrace(createMultiLineSourceMap(), [\n    'eval(\"throw new Error(\\'test\\')\");'\n  ], [\n    'Error: test',\n\n    // Before Node 4, `Object.eval`, after just `eval`.\n    /^    at (?:Object\\.)?eval \\(eval at <anonymous> \\((?:.*\\/)?line1\\.js:1001:101\\)/,\n\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line1\\.js:1001:101\\)$/\n  ]);\n});\n\nit('eval inside eval', function() {\n  compareStackTrace(createMultiLineSourceMap(), [\n    'eval(\"eval(\\'throw new Error(\\\\\"test\\\\\")\\')\");'\n  ], [\n    'Error: test',\n    /^    at (?:Object\\.)?eval \\(eval at <anonymous> \\(eval at <anonymous> \\((?:.*\\/)?line1\\.js:1001:101\\)/,\n    /^    at (?:Object\\.)?eval \\(eval at <anonymous> \\((?:.*\\/)?line1\\.js:1001:101\\)/,\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line1\\.js:1001:101\\)$/\n  ]);\n});\n\nit('eval inside function', function() {\n  compareStackTrace(createMultiLineSourceMap(), [\n    'function foo() {',\n    '  eval(\"throw new Error(\\'test\\')\");',\n    '}',\n    'foo();'\n  ], [\n    'Error: test',\n    /^    at eval \\(eval at foo \\((?:.*\\/)?line2\\.js:1002:102\\)/,\n    /^    at foo \\((?:.*\\/)?line2\\.js:1002:102\\)/,\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line4\\.js:1004:104\\)$/\n  ]);\n});\n\nit('eval with sourceURL', function() {\n  compareStackTrace(createMultiLineSourceMap(), [\n    'eval(\"throw new Error(\\'test\\')//@ sourceURL=sourceURL.js\");'\n  ], [\n    'Error: test',\n    /^    at (?:Object\\.)?eval \\(sourceURL\\.js:1:7\\)$/,\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line1\\.js:1001:101\\)$/\n  ]);\n});\n\nit('eval with sourceURL inside eval', function() {\n  compareStackTrace(createMultiLineSourceMap(), [\n    'eval(\"eval(\\'throw new Error(\\\\\"test\\\\\")//@ sourceURL=sourceURL.js\\')\");'\n  ], [\n    'Error: test',\n    /^    at (?:Object\\.)?eval \\(sourceURL\\.js:1:7\\)$/,\n    /^    at (?:Object\\.)?eval \\(eval at <anonymous> \\((?:.*\\/)?line1\\.js:1001:101\\)/,\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line1\\.js:1001:101\\)$/\n  ]);\n});\n\nit('native function', function() {\n  compareStackTrace(createSingleLineSourceMap(), [\n    '[1].map(function(x) { throw new Error(x); });'\n  ], [\n    'Error: 1',\n    /\\/.original\\.js/,\n    /at Array\\.map \\(native\\)/\n  ]);\n});\n\nit('function constructor', function() {\n  compareStackTrace(createMultiLineSourceMap(), [\n    'throw new Function(\")\");'\n  ], [\n    'SyntaxError: Unexpected token )',\n  ]);\n});\n\nit('throw with empty source map', function() {\n  compareStackTrace(createEmptySourceMap(), [\n    'throw new Error(\"test\");'\n  ], [\n    'Error: test',\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?.generated.js:1:34\\)$/\n  ]);\n});\n\nit('throw in Timeout with empty source map', function(done) {\n  compareStdout(done, createEmptySourceMap(), [\n    'require(\"./source-map-support\").install();',\n    'setTimeout(function () {',\n    '    throw new Error(\"this is the error\")',\n    '})'\n  ], [\n    /\\/.generated.js:3$/,\n    '    throw new Error(\"this is the error\")',\n    /^          \\^$/,\n    'Error: this is the error',\n    /^    at ((null)|(Timeout))\\._onTimeout \\((?:.*\\/)?.generated.js:3:11\\)$/\n  ]);\n});\n\nit('throw with source map with gap', function() {\n  compareStackTrace(createSourceMapWithGap(), [\n    'throw new Error(\"test\");'\n  ], [\n    'Error: test',\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?.generated.js:1:34\\)$/\n  ]);\n});\n\nit('sourcesContent with data URL', function() {\n  compareStackTrace(createMultiLineSourceMapWithSourcesContent(), [\n    'throw new Error(\"test\");'\n  ], [\n    'Error: test',\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?original.js:1001:5\\)$/\n  ]);\n});\n\nit('finds the last sourceMappingURL', function() {\n  compareStackTrace(createMultiLineSourceMapWithSourcesContent(), [\n    '//# sourceMappingURL=missing.map.js',  // NB: compareStackTrace adds another source mapping.\n    'throw new Error(\"test\");'\n  ], [\n    'Error: test',\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?original.js:1002:5\\)$/\n  ]);\n});\n\nit('default options', function(done) {\n  compareStdout(done, createSecondLineSourceMap(), [\n    '',\n    'function foo() { throw new Error(\"this is the error\"); }',\n    'require(\"./source-map-support\").install();',\n    'process.nextTick(foo);',\n    'process.nextTick(function() { process.exit(1); });'\n  ], [\n    /\\/.original\\.js:1$/,\n    'this is the original code',\n    '^',\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?.original\\.js:1:1\\)$/\n  ]);\n});\n\nit('handleUncaughtExceptions is true', function(done) {\n  compareStdout(done, createSecondLineSourceMap(), [\n    '',\n    'function foo() { throw new Error(\"this is the error\"); }',\n    'require(\"./source-map-support\").install({ handleUncaughtExceptions: true });',\n    'process.nextTick(foo);'\n  ], [\n    /\\/.original\\.js:1$/,\n    'this is the original code',\n    '^',\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?.original\\.js:1:1\\)$/\n  ]);\n});\n\nit('handleUncaughtExceptions is false', function(done) {\n  compareStdout(done, createSecondLineSourceMap(), [\n    '',\n    'function foo() { throw new Error(\"this is the error\"); }',\n    'require(\"./source-map-support\").install({ handleUncaughtExceptions: false });',\n    'process.nextTick(foo);'\n  ], [\n    /\\/.generated.js:2$/,\n    'function foo() { throw new Error(\"this is the error\"); }',\n\n    // Before Node 4, the arrow points on the `new`, after on the\n    // `throw`.\n    /^                 (?:      )?\\^$/,\n\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?.original\\.js:1:1\\)$/\n  ]);\n});\n\nit('default options with empty source map', function(done) {\n  compareStdout(done, createEmptySourceMap(), [\n    '',\n    'function foo() { throw new Error(\"this is the error\"); }',\n    'require(\"./source-map-support\").install();',\n    'process.nextTick(foo);'\n  ], [\n    /\\/.generated.js:2$/,\n    'function foo() { throw new Error(\"this is the error\"); }',\n    /^                 (?:      )?\\^$/,\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?.generated.js:2:24\\)$/\n  ]);\n});\n\nit('default options with source map with gap', function(done) {\n  compareStdout(done, createSourceMapWithGap(), [\n    '',\n    'function foo() { throw new Error(\"this is the error\"); }',\n    'require(\"./source-map-support\").install();',\n    'process.nextTick(foo);'\n  ], [\n    /\\/.generated.js:2$/,\n    'function foo() { throw new Error(\"this is the error\"); }',\n    /^                 (?:      )?\\^$/,\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?.generated.js:2:24\\)$/\n  ]);\n});\n\nit('specifically requested error source', function(done) {\n  compareStdout(done, createSecondLineSourceMap(), [\n    '',\n    'function foo() { throw new Error(\"this is the error\"); }',\n    'var sms = require(\"./source-map-support\");',\n    'sms.install({ handleUncaughtExceptions: false });',\n    'process.on(\"uncaughtException\", function (e) { console.log(\"SRC:\" + sms.getErrorSource(e)); });',\n    'process.nextTick(foo);'\n  ], [\n    /^SRC:.*\\/.original.js:1$/,\n    'this is the original code',\n    '^'\n  ]);\n});\n\nit('sourcesContent', function(done) {\n  compareStdout(done, createMultiLineSourceMapWithSourcesContent(), [\n    '',\n    'function foo() { throw new Error(\"this is the error\"); }',\n    'require(\"./source-map-support\").install();',\n    'process.nextTick(foo);',\n    'process.nextTick(function() { process.exit(1); });'\n  ], [\n    /\\/original\\.js:1002$/,\n    '    line 2',\n    '    ^',\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?original\\.js:1002:5\\)$/\n  ]);\n});\n\nit('missing source maps should also be cached', function(done) {\n  compareStdout(done, createSingleLineSourceMap(), [\n    '',\n    'var count = 0;',\n    'function foo() {',\n    '  console.log(new Error(\"this is the error\").stack.split(\"\\\\n\").slice(0, 2).join(\"\\\\n\"));',\n    '}',\n    'require(\"./source-map-support\").install({',\n    '  overrideRetrieveSourceMap: true,',\n    '  retrieveSourceMap: function(name) {',\n    '    if (/\\\\.generated.js$/.test(name)) count++;',\n    '    return null;',\n    '  }',\n    '});',\n    'process.nextTick(foo);',\n    'process.nextTick(foo);',\n    'process.nextTick(function() { console.log(count); });',\n  ], [\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?.generated.js:4:15\\)$/,\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?.generated.js:4:15\\)$/,\n    '1', // The retrieval should only be attempted once\n  ]);\n});\n\nit('should consult all retrieve source map providers', function(done) {\n  compareStdout(done, createSingleLineSourceMap(), [\n    '',\n    'var count = 0;',\n    'function foo() {',\n    '  console.log(new Error(\"this is the error\").stack.split(\"\\\\n\").slice(0, 2).join(\"\\\\n\"));',\n    '}',\n    'require(\"./source-map-support\").install({',\n    '  retrieveSourceMap: function(name) {',\n    '    if (/\\\\.generated.js$/.test(name)) count++;',\n    '    return undefined;',\n    '  }',\n    '});',\n    'require(\"./source-map-support\").install({',\n    '  retrieveSourceMap: function(name) {',\n    '    if (/\\\\.generated.js$/.test(name)) {',\n    '      count++;',\n    '      return ' + JSON.stringify({url: '.original.js', map: createMultiLineSourceMapWithSourcesContent().toJSON()}) + ';',\n    '    }',\n    '  }',\n    '});',\n    'process.nextTick(foo);',\n    'process.nextTick(foo);',\n    'process.nextTick(function() { console.log(count); });',\n  ], [\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?original.js:1004:5\\)$/,\n    'Error: this is the error',\n    /^    at foo \\((?:.*\\/)?original.js:1004:5\\)$/,\n    '1', // The retrieval should only be attempted once\n  ]);\n});\n\nit('should allow for runtime inline source maps', function(done) {\n  var sourceMap = createMultiLineSourceMapWithSourcesContent();\n\n  fs.writeFileSync('.generated.jss', 'foo');\n\n  compareStdout(function(err) {\n    fs.unlinkSync('.generated.jss');\n    done(err);\n  }, createSingleLineSourceMap(), [\n    'require(\"./source-map-support\").install({',\n    '  hookRequire: true',\n    '});',\n    'require.extensions[\".jss\"] = function(module, filename) {',\n    '  module._compile(',\n        JSON.stringify([\n          '',\n          'var count = 0;',\n          'function foo() {',\n          '  console.log(new Error(\"this is the error\").stack.split(\"\\\\n\").slice(0, 2).join(\"\\\\n\"));',\n          '}',\n          'process.nextTick(foo);',\n          'process.nextTick(foo);',\n          'process.nextTick(function() { console.log(count); });',\n          '//@ sourceMappingURL=data:application/json;charset=utf8;base64,' + new Buffer(sourceMap.toString()).toString('base64')\n        ].join('\\n')),\n        ', filename);',\n    '};',\n    'require(\"./.generated.jss\");',\n  ], [\n    'Error: this is the error',\n    /^    at foo \\(.*\\/original.js:1004:5\\)$/,\n    'Error: this is the error',\n    /^    at foo \\(.*\\/original.js:1004:5\\)$/,\n    '0', // The retrieval should only be attempted once\n  ]);\n});\n\n/* The following test duplicates some of the code in\n * `compareStackTrace` but appends a charset to the\n * source mapping url.\n */\nit('finds source maps with charset specified', function() {\n  var sourceMap = createMultiLineSourceMap()\n  var source = [ 'throw new Error(\"test\");' ];\n  var expected = [\n    'Error: test',\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line1\\.js:1001:101\\)$/\n  ];\n\n  fs.writeFileSync('.generated.js', 'exports.test = function() {' +\n    source.join('\\n') + '};//@ sourceMappingURL=data:application/json;charset=utf8;base64,' +\n    new Buffer(sourceMap.toString()).toString('base64'));\n  try {\n    delete require.cache[require.resolve('./.generated')];\n    require('./.generated').test();\n  } catch (e) {\n    compareLines(e.stack.split('\\n'), expected);\n  }\n  fs.unlinkSync('.generated.js');\n});\n\n/* The following test duplicates some of the code in\n * `compareStackTrace` but appends some code and a\n * comment to the source mapping url.\n */\nit('allows code/comments after sourceMappingURL', function() {\n  var sourceMap = createMultiLineSourceMap()\n  var source = [ 'throw new Error(\"test\");' ];\n  var expected = [\n    'Error: test',\n    /^    at Object\\.exports\\.test \\((?:.*\\/)?line1\\.js:1001:101\\)$/\n  ];\n\n  fs.writeFileSync('.generated.js', 'exports.test = function() {' +\n    source.join('\\n') + '};//# sourceMappingURL=data:application/json;base64,' +\n    new Buffer(sourceMap.toString()).toString('base64') +\n    '\\n// Some comment below the sourceMappingURL\\nvar foo = 0;');\n  try {\n    delete require.cache[require.resolve('./.generated')];\n    require('./.generated').test();\n  } catch (e) {\n    compareLines(e.stack.split('\\n'), expected);\n  }\n  fs.unlinkSync('.generated.js');\n});\n\nit('handleUncaughtExceptions is true with existing listener', function(done) {\n  var source = [\n    'process.on(\"uncaughtException\", function() { /* Silent */ });',\n    'function foo() { throw new Error(\"this is the error\"); }',\n    'require(\"./source-map-support\").install();',\n    'process.nextTick(foo);',\n    '//@ sourceMappingURL=.generated.js.map'\n  ];\n\n  fs.writeFileSync('.original.js', 'this is the original code');\n  fs.writeFileSync('.generated.js.map', createSingleLineSourceMap());\n  fs.writeFileSync('.generated.js', source.join('\\n'));\n\n  child_process.exec('node ./.generated', function(error, stdout, stderr) {\n    fs.unlinkSync('.generated.js');\n    fs.unlinkSync('.generated.js.map');\n    fs.unlinkSync('.original.js');\n    assert.equal((stdout + stderr).trim(), '');\n    done();\n  });\n});\n"]}