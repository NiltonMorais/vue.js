{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n\nvar _symbol = require(\"babel-runtime/core-js/symbol\");\n\nvar _symbol2 = _interopRequireDefault(_symbol);\n\nexports.default = function (code, opts) {\n  var stack = void 0;\n  try {\n    throw new Error();\n  } catch (error) {\n    if (error.stack) {\n      stack = error.stack.split(\"\\n\").slice(1).join(\"\\n\");\n    }\n  }\n\n  opts = (0, _assign2.default)({\n    allowReturnOutsideFunction: true,\n    allowSuperOutsideMethod: true,\n    preserveComments: false\n  }, opts);\n\n  var _getAst = function getAst() {\n    var ast = void 0;\n\n    try {\n      ast = babylon.parse(code, opts);\n\n      ast = _babelTraverse2.default.removeProperties(ast, { preserveComments: opts.preserveComments });\n\n      _babelTraverse2.default.cheap(ast, function (node) {\n        node[FROM_TEMPLATE] = true;\n      });\n    } catch (err) {\n      err.stack = err.stack + \"from\\n\" + stack;\n      throw err;\n    }\n\n    _getAst = function getAst() {\n      return ast;\n    };\n\n    return ast;\n  };\n\n  return function () {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return useTemplate(_getAst(), args);\n  };\n};\n\nvar _cloneDeep = require(\"lodash/cloneDeep\");\n\nvar _cloneDeep2 = _interopRequireDefault(_cloneDeep);\n\nvar _assign = require(\"lodash/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nvar _has = require(\"lodash/has\");\n\nvar _has2 = _interopRequireDefault(_has);\n\nvar _babelTraverse = require(\"babel-traverse\");\n\nvar _babelTraverse2 = _interopRequireDefault(_babelTraverse);\n\nvar _babylon = require(\"babylon\");\n\nvar babylon = _interopRequireWildcard(_babylon);\n\nvar _babelTypes = require(\"babel-types\");\n\nvar t = _interopRequireWildcard(_babelTypes);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar FROM_TEMPLATE = \"_fromTemplate\";\nvar TEMPLATE_SKIP = (0, _symbol2.default)();\n\nfunction useTemplate(ast, nodes) {\n  ast = (0, _cloneDeep2.default)(ast);\n  var _ast = ast;\n  var program = _ast.program;\n\n\n  if (nodes.length) {\n    (0, _babelTraverse2.default)(ast, templateVisitor, null, nodes);\n  }\n\n  if (program.body.length > 1) {\n    return program.body;\n  } else {\n    return program.body[0];\n  }\n}\n\nvar templateVisitor = {\n  noScope: true,\n\n  enter: function enter(path, args) {\n    var node = path.node;\n\n    if (node[TEMPLATE_SKIP]) return path.skip();\n\n    if (t.isExpressionStatement(node)) {\n      node = node.expression;\n    }\n\n    var replacement = void 0;\n\n    if (t.isIdentifier(node) && node[FROM_TEMPLATE]) {\n      if ((0, _has2.default)(args[0], node.name)) {\n        replacement = args[0][node.name];\n      } else if (node.name[0] === \"$\") {\n        var i = +node.name.slice(1);\n        if (args[i]) replacement = args[i];\n      }\n    }\n\n    if (replacement === null) {\n      path.remove();\n    }\n\n    if (replacement) {\n      replacement[TEMPLATE_SKIP] = true;\n      path.replaceInline(replacement);\n    }\n  },\n  exit: function exit(_ref) {\n    var node = _ref.node;\n\n    if (!node.loc) _babelTraverse2.default.clearNode(node);\n  }\n};\nmodule.exports = exports[\"default\"];"]}